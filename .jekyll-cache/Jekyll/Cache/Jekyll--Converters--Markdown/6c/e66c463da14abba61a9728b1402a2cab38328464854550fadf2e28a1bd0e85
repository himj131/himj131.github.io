I"<h2 id="카프카란">카프카란</h2>
<p>카프카는 Pub/Sub 모델 기반의 메시징 서버로, 링크드인에서 자체적으로 사용하기 위해 만든 분산 데이터 스트림 플랫폼이다.
기존 메세징 시스템에 비해 처리량이 높고, 파티셔닝이나 복제기능을 갖고 있어 대규모 메시지 처리에 적합한 시스템이다.</p>

<p>카프카는 사내 모든 데이터시스템이나 마이크로서비스와 연결된 이벤트/데이터 스트림 파이프라인의 중앙허브 역할을 목적으로 개발되었고,
카프카 로고에도 이런 철학이 잘 반영되어 있다.</p>

<p><a href="https://kafka.apache.org/"><img src="/assets/images/kafka/kafkalogo.png" alt="카프카 로고" width="500" height="500" /></a></p>

<p>카프카의 특징은 다음과 같다.</p>

<h5 id="멀티-프로듀서-멀티-컨슈머">멀티 프로듀서, 멀티 컨슈머</h5>
<p>하나의 토픽에 여러 프로듀서나 컨슈머가 접근 가능하다.
프로듀서는 하나 이상의 토픽에 메세지를 보낼수 있고, 컨슈머 역시 하나 이상의 토픽으로부터 메세지를 읽어올 수 있다.</p>

<h5 id="메세지의-저장">메세지의 저장</h5>
<p>일반적인 메시징 시스템에서는 컨슈머가 메시지를 읽어가면 큐에서 바로 메시지를 삭제한다. 
하지만 카프카는 일정 주기만큼 메시지를 디스크에 저장해둔다.
따라서 컨슈머의 메시지 처리가 늦어지거나 컨슈머의 중단이 발생하더라도 메시지의 손실이 없으며, 
한번 읽은 메시지를 여러번 다시 읽을 수 있다.</p>

<h5 id="확장성scalability">확장성(Scalability)</h5>
<p>카프카 클러스터는 3개(권장)의 브로커에서 수십대의 브로커로 확장이 가능하다. 확장 작업도 서비스 중단없이 비교적 간단하게 진행할 수 있다.</p>

<h5 id="낮은-지연-빠른-처리-속도">낮은 지연 빠른 처리 속도</h5>
<p>카프카는 배치전송(작은 메시지들을 묶어 한번에 보내서 네트워크 왕복 오버헤드를 줄임)과 
페이지 캐시(메모리의 일부를 사용)를 사용해 속도가 빠르다.</p>

<h5 id="고가용성high-availability-결함에-강함fault-tolerant">고가용성(High availability), 결함에 강함(Fault-tolerant)</h5>
<p>카프카는 분산 시스템을 사용하기 때문에 단일 시스템보다 더 높은 성능을 얻을 수 있고 시스템 확장이 용이하다. 또한 분산시스템 중 하나의 서버에 
장애가 발생해도 다른 서버가 데이터 손실 없이 작업을 대신한다.</p>

<p>#####</p>

<h2 id="kafka-구성-요소와-역할">Kafka 구성 요소와 역할</h2>
<ul>
  <li>Zookeeper(주키퍼)
    <ul>
      <li>카프카는 분산 애플리케이션을 관리하는 코디네이션으로 주키퍼를 사용한다.</li>
      <li>주키퍼는 분산되어있는 각 애플리케이션의 정보를 관리하고, 동기화등을 처리한다.</li>
      <li>분산 애플리케이션들은 각각 클라이언트가 되어 주키퍼 서버들과 커넥션을 맺어 상태정보 등을 주고 받는다.</li>
      <li>상태 정보들은 주키퍼 지노드(znode)라 불리는곳에 key-value 형태로 저장되고 이값을 가지고 분산 애플리케이션들은 서로 데이터를 주고 받는다.</li>
    </ul>
  </li>
  <li>Broker(브로커)
    <ul>
      <li>카프카 애플리케이션이 설치되어있는 서버로 데이터 저장소 역할을 한다.</li>
    </ul>
  </li>
  <li>Producer(프로듀서)
    <ul>
      <li>메시지를 생산하는 애플리케이션으로, 브로커의 토픽을 지정하여 메시지를 보낸다.</li>
    </ul>
  </li>
  <li>Consumer(컨슈머)
    <ul>
      <li>저장된 메시지를 가져가서 사용하는 서버 또는 애플리케이션</li>
      <li>특정 파티션을 관리하고 있는 파티션 리더에게 메시지 가져오기 요청을 한다.</li>
      <li>각 요청에 오프셋을 명시할 수 있어, 컨슈머는 가져올 메시지의 위치를 조정할 수 있고, 이미 가져온 데이터도 다시 가져올 수 있다.</li>
    </ul>
  </li>
</ul>

<h2 id="kafka-동작-방식">Kafka 동작 방식</h2>
<p>z</p>
<blockquote>
  <p>topic(토픽)과 partition(파티션) : 토픽은 데이터를 구분하는 논리적 개념이고, 파티션은 토픽을 구성하는 데이터 저장소 역할이다.
카프카 클러스터는 토픽이라는 곳에 데이터를 저장한다.</p>
</blockquote>
:ET